<!--
    Authors:
        - Lucas Smith
        - Kate Belson 
        - Jack Purkiss 
-->
{% extends 'base.html' %}
<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <meta charset="UTF-8">
    <title>{{user.username}}'s profile</title>
    
</head>

<body>


{% block filter %}

{% include 'sidebar.html' %}

{% endblock %}

{% block content %}
<!--Written by Kate Belson, Lucas Smith Jack Purkiss-->

{% load static %}
<link rel="stylesheet" href="{% static 'StyleSheet.css'%}">



<!-- Mist of this is for bootstrap (or whatever CSS we end up using) -->

<div class="content-section">
    {% csrf_token %}
    <div class="media">
        <img class="rounded-circle account-img" src="{{ user.profile.picture.url }}" width="100" height="100"></img>
        <div class="media-body">
            <h1>{{user.username}}'s profile</h1>
            <h4>{{user.profile.university }}</h4>
            <h4>{{user.profile.bio}}</h4>
            <br>
            {% if editable %}
                <div style="width:500px">
                    <a href="/profile_edit" class="profile_button">Edit profile</a>
                    <a href="{% url 'deleteProfile' %}" class="profile_button">Delete profile</a><br>
                    {% if game_master == False %}
                        <a href="{% url 'requestMaster' %}" class="profile_button">Become a Game Master</a>
                    {% endif %}
                </div>

            {% else %}
                {% if following %}
                    <div style="width:500px">
                        <a href=/follow/{{user.username}} class="profile_button" >Unfollow</a><br>
                    </div>
                {% else %}
                    <div style="width:500px">
                        <a href=/follow/{{user.username}} class="profile_button" >Follow</a><br>
                    </div>
                {% endif %}
            {% endif %}


        </div>
    </div>
</div>

<div class="account_page">
    <h1>{{user.username}}'s Completed Challenges</h1>
    <h4>Total Points: {{request.user.profile.points}}</h4>

    {% for response in responses %}
    <div class="challenge">
        <p><a href="{% url 'challengeResponses' response.challenge.id %}">{{response.challenge.name}}</a> | <small>{{response.challenge.points}}</small>
            <a href="{% url 'reportAPost' response.id %}" class="button">Report Post</a>
            <br>
        </p>
        <img id="chal-photo" src="{{ response.photograph.url }}" alt="image" />
        <br>
        <small>{{response.description}}</small> <br>
        {% include 'like.html' %}
        <small>Comments: </small><br>
        <small><a href="{% url 'createComments' response.id %}">Add Comment</a></small><br><hr> 
        {% if not response.comments.all %}
            <small>No comments yet</small>

        {%else%}
        <small><a href="{% url 'viewComments' response.id %}">See All Comments</a></small>
            <div  style= "height: 100px; overflow-y: scroll;" >
                {% for comment in comments %}
                    {% if comment.response == response %}
                    <small> <a  href="{% url 'userResponses' comment.user.id%}">{{comment.user}}</a> {{comment.text}} </small>
                    <br>
                    {% endif %}
                {% endfor %}
        {% endif %}

            </div>
            
    </div>
    {% endfor %}
</div>

</body>

{% load static %}
    <script src="{% static '/scripts/likes.js' %}"></script>

{% endblock %}




</html>